<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EWS Banjir</title>
    <link rel="stylesheet" href="css/ews-banjir.css" />

    <!-- chart.js CDN -->
    <script
      src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"
      defer
    ></script>

    <!-- Script untuk keluarkan grafik dari database -->
    <script src="script/script-grafik.js" defer></script>
   
  </head>
  <body>
    <div class="header">
      <img id="logo" src="gambar/logobpbd.png" alt="gambar logo" />
      <h1>Pantau Kondisi Aliran Sungai Batang Merao 1</h1>
    </div>

    <main class="container">
      <!-- GRAFIK  -->
      <section class="card chart-card">
        <h2>Selamat Datang<span id="welcom"></span></h2>
        <h2>GRAFIK WAKTU VS KETINGGIAN AIR TERKINI</h2>

        <div class="controls">
          <label>
            Perbaharui Setiap
            <select id="refreshInterval">
              <option value="0">Jangan auto-refresh</option>
              option>
              <option value="5000">5 Detik</option>
              option>
              <option value="20000">20 Detik</option>
              option>
              <option value="60000">1 Menit</option>
              option>
              <option value="300000">5 Menit</option>
              option>
              <option value="600000">10 Menit</option>
              option>
              <option value="3600000">1 jam</option>
              option>
            </select>
          </label>
          <button id="btnRefresh">Refresh Sekarang</button>
          
        </div>
        <div class="tinggiAirTerkini">
          <p>
            Ketinggian Air Saat Ini : <span id="ketinggian-air"></span>
          </p>
          <p>Status Ketinggian Air : <span id="status-tinggi-air"></span></p>
        </div>
        <div class="chart-wrap">
          <canvas
            id="chartTinggiAir"
            aria-label="Grafik Tinggi Air"
            role="img"
          ></canvas>
        </div>
      </section>

      <!-- DATA DARI DATABASE -->
      <section class="card data-card">
        <h2>Data Terekam Dari Sensor Ketinggian Permukaan Air</h2>
        <div class="table-wrap">
          <table id="dataTable">
            <thead>
              <tr>
                <th>ID</th>
                <th>Tinggi Air</th>
                <th>Lokasi EWS</th>
                <th>Waktu</th>
              </tr>
            </thead>
            <tbody>
              <!-- Isi via JS -->
            </tbody>
          </table>
        </div>
      </section>

      <footer>
        <p>
          &copy; <span id="tahun"></span>Persembahan dari PT. Solusi Digital
          Andalas untuk BPBD Kota Sungai Penuh
        </p>

        <blockquote>
          "Bersama Menjaga Keselamatan dan Kesiapsiagaan Masyarakat"
        </blockquote>
      </footer>
    </main>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const tahun = document.getElementById("tahun");
        tahun.textContent = new Date().getFullYear();

        const welcomEl = document.getElementById("welcom");
        const namaLengkap = localStorage.getItem("nama_lengkap") || "Pengguna";
        welcomEl.textContent = `, ${namaLengkap}`;
      });
    </script>
     <script src="script/script-tinggi-air-terakhir.js"></script>
  </body>
</html>
